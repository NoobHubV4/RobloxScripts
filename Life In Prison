local lib = loadstring(game:HttpGet("https://raw.github.com/NoobHubV1/NoobHubV1/main/Wizard%20Lib.lua"))()
local Window = lib:NewWindow("Life In Prison")
local Main = Window:NewSection("Main")
local Team = Window:NewSection("Team")
local Main2 = Window:NewSection("Kill Or Arrest")
local SavedPositions = {AutoRe = nil}
local Connections = {Died = nil;}
local Camera = game:FindService("Workspace").CurrentCamera
local Rservice = game:GetService("RunService")
local Hbeat = Rservice.Heartbeat
local Rstep = Rservice.RenderStepped
local Stepped = Rservice.Stepped
local LocalPlayer = game.Players.localPlayer
local Teams = game.Teams
local autoRespawn = nil
local killAura = nil
local remote = game.ReplicatedStorage.RemoteEvent
local source = workspace.pickups:FindFirstChild("AWM"):FindFirstChild("~+\198\005C\221%\196jq\239\208\236\153\015\221\152++\222\255\15738E\133Q\151\1980\135\150\222f\164:\153\181\173\t\221\1891\152\185\160\127c\1967")

local LocTP = function(cframe)
	LocalPlayer.Character:FindFirstChild("HumanoidRootPart").CFrame = cframe
end

function FindMedkit()
    for i, v in ipairs(workspace.pickups:GetChildren()) do
        if v.Name == "Medkit" then
            return v:FindFirstChild("Meshes/outside")
        end
    end
end

function GetAwm()
    SavedPositions.Gun = LocalPlayer.Character.HumanoidRootPart.CFrame
    repeat task.wait()
        game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = source.CFrame
        remote:FireServer("ItemHandler",source)
    until LocalPlayer.Character:FindFirstChild("AWM") or LocalPlayer.Backpack:FindFirstChild("AWM")
    LocalPlayer.Character.HumanoidRootPart.CFrame = SavedPositions.Gun
end
function PlaceMedkit()
    local medkit = FindMedkit()
    SavedPositions.Medkit = LocalPlayer.Character.HumanoidRootPart.CFrame
    repeat task.wait()
        game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = medkit.CFrame
        remote:FireServer("ItemHandler",medkit)
    until LocalPlayer.Character:FindFirstChild("Medkit") or LocalPlayer.Backpack:FindFirstChild("Medkit")
    LocalPlayer.Character.HumanoidRootPart.CFrame = SavedPositions.Medkit
    repeat task.wait()
        game.Players.LocalPlayer.Character.Humanoid:EquipTool(LocalPlayer.Backpack:FindFirstChild("Medkit"))
    until LocalPlayer.Character:FindFirstChild("Medkit")
    wait(.25)
    remote:FireServer("PlaceMedkit",LocalPlayer.Character:FindFirstChild("Medkit"))
end
function SaveCamPos()
	SavedPositions.OldCameraPos = Camera.CFrame
end
function LoadCamPos()
	Rstep:Wait()
	Camera.CFrame = SavedPositions.OldCameraPos or Camera.CFrame
end

function TeamTo(args)
  local tmp = LocalPlayer.Character.HumanoidRootPart.CFrame; SavedPositions.AutoRe = tmp; SaveCamPos()
  remote:FireServer("ChangeTeam", Teams.Neutral)
  if args == "criminal" then
    remote:FireServer("ChangeTeam", Teams.Criminals)
  elseif args == "inmate" then
    remote:FireServer("ChangeTeam", Teams.Prisoners)
  elseif args == "guard" then
    remote:FireServer("ChangeTeam", Teams.Police)
  end; LocalPlayer.CharacterAdded:Wait()
		if waitfor(LocalPlayer.Character, "HumanoidRootPart", 4) then
			LocTP(tmp)
		end; LoadCamPos()
end

function Refresh()
    local team = LocalPlayer.Team; local tmp = LocalPlayer.Character.HumanoidRootPart.CFrame; SavedPositions.AutoRe = tmp; SaveCamPos()
    if team == Teams.Criminals then
        remote:FireServer("ChangeTeam", Teams.Neutral)
        remote:FireServer("ChangeTeam", Teams.Criminals)
    elseif team == Teams.Prisoners then
        remote:FireServer("ChangeTeam", Teams.Neutral)
        remote:FireServer("ChangeTeam", Teams.Prisoners)
    elseif team == Teams.Police then
        remote:FireServer("ChangeTeam", Teams.Neutral)
        remote:FireServer("ChangeTeam", Teams.Police)
    else
        remote:FireServer("ChangeTeam", Teams.Prisoners)
        remote:FireServer("ChangeTeam", Teams.Neutral)
    end; LocalPlayer.CharacterAdded:Wait()
		if waitfor(LocalPlayer.Character, "HumanoidRootPart", 4) then
			LocTP(tmp)
		end; LoadCamPos()
end

waitfor = function(source, args, interval)
	local int = interval or 5
	local timeout = tick() + int
	repeat Stepped:Wait() until source:FindFirstChild(args) or tick() - timeout >=0
	timeout = nil
	if source:FindFirstChild(args) then
		return source:FindFirstChild(args)
	else
		return nil
	end
end

Main:CreateButton("Refresh", function()
  Refresh()
end)

Main:CreateToggle("Auto Respawn", function(state)
  autoRespawn = state
end)

Main:CreateToggle("Kill Aura", function(state)
  killAura = state
end)

Main:CreateButton("Get Awm Gun", function()
  GetAwm()
end)

Main:CreateButton("Place Medkit", function()
  PlaceMedkit()
end)

Team:CreateButton("Criminal", function()
  TeamTo("criminal")
end)

Team:CreateButton("Inmate", function()
  TeamTo("inmate")
end)

Team:CreateButton("Guard", function()
  TeamTo("guard")
end)

Team:CreateButton("Neutral", function()
  remote:FireServer("ChangeTeam", Teams.Neutral)
end)

Main2:CreateButton("Arrest All", function()
  for i,v in pairs(game.Teams.Criminals:GetPlayers()) do
    if not v.Character:FindFirstChild("ForceField") and v.Character.Humanoid.Health ~= 0 and v ~= game.Players.LocalPlayer then
      repeat task.wait()
        LocalPlayer.Character.HumanoidRootPart.CFrame = v.Character.HumanoidRootPart.CFrame
        remote:FireServer("Handcuffs", v)
      until v.Character.Head:FindFirstChild("handcuffedGui")
    end
  end
end)

Main2:CreateButton("Kill All", function()
  for i,v in pairs(game.Players:GetPlayers()) do
    if not v.Character:FindFirstChild("ForceField") and v.Character.Humanoid.Health ~= 0 and v ~= game.Players.LocalPlayer then
      repeat task.wait()
        LocalPlayer.Character.HumanoidRootPart.CFrame = v.Character.HumanoidRootPart.CFrame
        remote:FireServer("meleeEvent", v.Character.Humanoid)
      until v.Character.Humanoid.Health == 0
    end
  end
end)

local lochar = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local function ondiedevent()
	coroutine.wrap(function()
		Connections.Died:Disconnect(); SaveCamPos()
		SavedPositions.AutoRe = lochar:WaitForChild("HumanoidRootPart", 1) and LocalPlayer.Character:FindFirstChild("HumanoidRootPart").CFrame; Camera.CameraType = Enum.CameraType.Track
        if autoRespawn then
            local team = LocalPlayer.Team
            if team == Teams.Criminals then
                remote:FireServer("ChangeTeam", Teams.Neutral)
                remote:FireServer("ChangeTeam", Teams.Criminals)
            elseif team == Teams.Prisoners then
                remote:FireServer("ChangeTeam", Teams.Neutral)
                remote:FireServer("ChangeTeam", Teams.Prisoners)
            elseif team == Teams.Police then
                remote:FireServer("ChangeTeam", Teams.Neutral)
                remote:FireServer("ChangeTeam", Teams.Police)
            else
                remote:FireServer("ChangeTeam", Teams.Prisoners)
                remote:FireServer("ChangeTeam", Teams.Neutral)
            end
        end
	end)()
end
local function charaddtask()
	local LHuman = lochar:WaitForChild("Humanoid", 1)
	if LHuman then
        if Connections.Died then Connections.Died:Disconnect(); Connections.Died = nil end
        if Connections.Animation then Connections.Animation:Disconnect(); Connections.Animation = nil end
		Connections.Died = LHuman.Died:Connect(ondiedevent)
        Connections.Animation = LHuman.AnimationPlayed:Connect(function(anim)
               if autoRespawn and anim.Animation.AnimationId == "rbxassetid://125882711002228" then
                      Refresh()
               end
        end)
	end
end
local function oncharadded()
	lochar = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
	if SavedPositions.AutoRe and autoRespawn then
		local LRoot = lochar:WaitForChild("HumanoidRootPart", 1)
		if LRoot then
			LRoot.CFrame = SavedPositions.AutoRe; LoadCamPos(); LRoot.CFrame = SavedPositions.AutoRe
			task.spawn(function()
				for i = 1, 4 do
					task.wait(); LRoot.CFrame = SavedPositions.AutoRe
				end
			end)
		end
	end
	lochar:WaitForChild("Humanoid", 1):SetStateEnabled(Enum.HumanoidStateType.FallingDown, false)
	lochar:WaitForChild("Humanoid", 1):SetStateEnabled(Enum.HumanoidStateType.Ragdoll, false)
  coroutine.wrap(charaddtask)()
end
Connections.Died = lochar:WaitForChild("Humanoid").Died:Connect(ondiedevent)
Connections.CharacterAdded = LocalPlayer.CharacterAdded:Connect(function(newChar)
  oncharadded()
  newChar.Head.ChildAdded:Connect(function(child)
    if autoRespawn and child.Name == "handcuffedGui" then
      Refresh()
    end
  end)
end)

task.spawn(function()
  task1 = function()
    if killAura then
      for i,v in ipairs(game.Players:GetPlayers()) do
        if not v.Character:FindFirstChild("ForceField") and v.Character.Humanoid.Health ~= 0 then
          if v ~= LocalPlayer and (LocalPlayer.Character.HumanoidRootPart.Position - v.Character.HumanoidRootPart.Position).Magnitude <= 25 then
            remote:FireServer("meleeEvent", v.Character:FindFirstChild("Humanoid"))
          end
        end
      end
    end
  end
  while task.wait() do
    task.spawn(task1)
  end
end)
