local DrRayLibrary = loadstring(game:HttpGet("https://raw.githubusercontent.com/NoobHubV1/NoobHubV1/main/Dr%20Ray%20Lib.lua"))()
local window = DrRayLibrary:Load("Life In Prison", "Default")
local Main = DrRayLibrary.newTab("Main", "")
local Team = DrRayLibrary.newTab("Team", "")
local Items = DrRayLibrary.newTab("Items", "")
local SavedPositions = {AutoRe = nil; Item = nil; Medkit = nil; Kill = nil; Arrest = nil}
local Connections = {Died = nil; Animation = nil; CharacterAdded = nil}
local Camera = game:FindService("Workspace").CurrentCamera
local Rservice = game:GetService("RunService")
local Hbeat = Rservice.Heartbeat
local Rstep = Rservice.RenderStepped
local Stepped = Rservice.Stepped
local LocalPlayer = game.Players.localPlayer
local Teams = game.Teams
local autoRespawn, killAura
local forceField, sent
local antiTase, antiArrest
local looped, copyChat
local Saved = {NormalSpeed = 16; AutoRespawn = nil; wascriminal = nil}

local LocTP = function(cframe)
	LocalPlayer.Character:FindFirstChild("HumanoidRootPart").CFrame = cframe
end

function FindSource(name)
    for i, v in ipairs(workspace.pickups:GetChildren()) do
        if v.Name == name then
            return v
        end
    end
end

function GetItem(source)
    SavedPositions.Item = LocalPlayer.Character.HumanoidRootPart.CFrame
    repeat task.wait()
        game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = source.CFrame
        game.ReplicatedStorage.RemoteEvent:FireServer("ItemHandler",source)
    until LocalPlayer.Character:FindFirstChild(source.Parent.Name) or LocalPlayer.Backpack:FindFirstChild(source.Parent.Name)
    LocalPlayer.Character.HumanoidRootPart.CFrame = SavedPositions.Item
end
function SaveCamPos()
	SavedPositions.OldCameraPos = Camera.CFrame
end
function LoadCamPos()
	Rstep:Wait()
	Camera.CFrame = SavedPositions.OldCameraPos or Camera.CFrame
end

function TeamTo(args)
  local tmp = LocalPlayer.Character.HumanoidRootPart.CFrame; SavedPositions.AutoRe = tmp; SaveCamPos()
  game.ReplicatedStorage.RemoteEvent:FireServer("ChangeTeam", Teams.Neutral)
  if args == "criminal" then
    game.ReplicatedStorage.RemoteEvent:FireServer("ChangeTeam", Teams.Criminals)
  elseif args == "inmate" then
    game.ReplicatedStorage.RemoteEvent:FireServer("ChangeTeam", Teams.Prisoners)
  elseif args == "guard" then
    game.ReplicatedStorage.RemoteEvent:FireServer("ChangeTeam", Teams.Police)
  end; LocalPlayer.CharacterAdded:Wait()
		if waitfor(LocalPlayer.Character, "HumanoidRootPart", 5) then
			LocTP(tmp)
		end; LoadCamPos()
end

function Refresh()
    local team = LocalPlayer.Team; local tmp = LocalPlayer.Character.HumanoidRootPart.CFrame; SavedPositions.AutoRe = tmp; SaveCamPos()
    if team == Teams.Criminals then
        game.ReplicatedStorage.RemoteEvent:FireServer("ChangeTeam", Teams.Neutral)
        game.ReplicatedStorage.RemoteEvent:FireServer("ChangeTeam", Teams.Criminals)
    elseif team == Teams.Prisoners then
        game.ReplicatedStorage.RemoteEvent:FireServer("ChangeTeam", Teams.Neutral)
        game.ReplicatedStorage.RemoteEvent:FireServer("ChangeTeam", Teams.Prisoners)
    elseif team == Teams.Police then
        game.ReplicatedStorage.RemoteEvent:FireServer("ChangeTeam", Teams.Neutral)
        game.ReplicatedStorage.RemoteEvent:FireServer("ChangeTeam", Teams.Police)
    else
        game.ReplicatedStorage.RemoteEvent:FireServer("ChangeTeam", Teams.Prisoners)
        game.ReplicatedStorage.RemoteEvent:FireServer("ChangeTeam", Teams.Neutral)
    end; LocalPlayer.CharacterAdded:Wait()
		if waitfor(LocalPlayer.Character, "HumanoidRootPart", 5) then
			LocTP(tmp)
		end; LoadCamPos()
end

waitfor = function(source, args, interval)
	local int = interval or 5
	local timeout = tick() + int
	repeat Stepped:Wait() until source:FindFirstChild(args) or tick() - timeout >=0
	timeout = nil
	if source:FindFirstChild(args) then
		return source:FindFirstChild(args)
	else
		return nil
	end
end

function CopyChat(player)
    player.Chatted:Connect(function(msg)
        if copyChat and msg then
            game.TextChatService.TextChannels.RBXGeneral:SendAsync("["..player.DisplayName.."]: "..msg)
        end
    end)
end

Main.newButton("Refresh", "", function()
    Refresh()
end)
Main.newToggle("Auto Respawn", "", false, function(state)
  autoRespawn = state
  Saved.AutoRespawn = state
end)

Main.newToggle("Kill Aura", "", false, function(state)
  killAura = state
end)

Main.newButton("Place Medkit", "", function()
  local medkit = FindSource("Medkit"):FindFirstChild("Meshes/outside"); SavedPositions.Medkit = LocalPlayer.Character.HumanoidRootPart.CFrame
    repeat task.wait()
        game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = medkit.CFrame
        game.ReplicatedStorage.RemoteEvent:FireServer("ItemHandler",medkit)
    until LocalPlayer.Character:FindFirstChild("Medkit") or LocalPlayer.Backpack:FindFirstChild("Medkit"); LocalPlayer.Character.HumanoidRootPart.CFrame = SavedPositions.Medkit; game.Players.LocalPlayer.Character.Humanoid:EquipTool(LocalPlayer.Backpack:FindFirstChild("Medkit"))
    wait(.15)
    game.ReplicatedStorage.RemoteEvent:FireServer("PlaceMedkit",LocalPlayer.Character:FindFirstChild("Medkit"))
end)

Main.newToggle("Anti Tase", "", false, function(state)
  antiTase = state
end)

Main.newToggle("Anti Arrest", "", false, function(state)
  antiArrest = state
end)

Team.newButton("Criminal", "", function()
  TeamTo("criminal")
end)

Team.newButton("Prisoners", "", function()
  TeamTo("inmate")
end)

Team.newButton("Police", "", function()
  TeamTo("guard")
end)

Items.newButton("Get AWM", "", function()
  GetItem(workspace.pickups.AWM:FindFirstChildOfClass("MeshPart"))
end)
Items.newButton("Get M9", "", function()
  GetItem(workspace.pickups.M9["T\016+\195\198V\149\194\172i\173\007\182\025\153\178\003\246\172M\241\166D\252\226\162\185N\181\165\141\008\214R\237\166\248\225Y\250\158tS\1524\127\179N\252."])
end)

Team.newButton("Neutral", "", function()
  game.ReplicatedStorage.RemoteEvent:FireServer("ChangeTeam", Teams.Neutral)
end)

Main.newButton("Arrest All", "", function()
  for i,v in pairs(game.Teams.Criminals:GetPlayers()) do
    if not v.Character:FindFirstChild("ForceField") and v.Character.Humanoid.Health ~= 0 and v ~= game.Players.LocalPlayer then
      SavedPositions.Arrest = LocalPlayer.Character:FindFirstChild("HumanoidRootPart", 1) and LocalPlayer.Character.HumanoidRootPart.CFrame
      repeat task.wait()
        LocalPlayer.Character.Humanoid.Sit = false
        LocalPlayer.Character.HumanoidRootPart.CFrame = v.Character.HumanoidRootPart.CFrame
        game.ReplicatedStorage.RemoteEvent:FireServer("Handcuffs", v)
      until v.Character.Head:FindFirstChild("handcuffedGui")
      LocTP(SavedPositions.Arrest)
    end
  end
end)

Items.newButton("Get MP5", "", function()
  GetItem(workspace.pickups.MP5["p0\172\165\127A\178f\172\183f=\208O\214\244\241\192\1685Eqd\197\2020\023\184|\249wy\241\003H\017R\151\220\146\019\213\229\151\014\160\184\244WK"])
end)

Main.newButton("Kill All", "", function()
  for i,v in pairs(game.Players:GetPlayers()) do
    if not v.Character:FindFirstChild("ForceField") and v.Character.Humanoid.Health ~= 0 and v ~= game.Players.LocalPlayer then
      SavedPositions.Kill = LocalPlayer.Character:FindFirstChild("HumanoidRootPart", 1) and LocalPlayer.Character.HumanoidRootPart.CFrame
      repeat task.wait()
        LocalPlayer.Character.Humanoid.Sit = false
        LocalPlayer.Character.HumanoidRootPart.CFrame = v.Character.HumanoidRootPart.CFrame
        game.ReplicatedStorage.RemoteEvent:FireServer("meleeEvent", v.Character.Humanoid)
      until v.Character.Humanoid.Health == 0
      LocTP(SavedPositions.Kill)
    end
  end
end)

Items.newButton("Get DB Shotgun", "", function()
  GetItem(workspace.pickups["DB Shotgun"]["Go2\239\027\190\026\018d\012L[\185m\020\178\146\2472\150\236\197\\\164\246]R,YK1\200>\227\137\011\215\161\166\016\163\206\":\017E\224V\243\029"])
end)

Items.newButton('Get AK 74', "", function()
  GetItem(workspace.pickups["AK-74"]["U\215\225Kc\143Z\1867R\183)\243m\152\241\207@]\016`\236Z\209\144\226\159$\229\196\029\163.\202\195U*?\242\024\248\170\153\241\145m\239\018\2117"])
end)

Items.newButton("Get AR 15", "", function()
  GetItem(workspace.pickups["AR-15"]["Jgx\012\149\230\248\242\005\006\243\020\206\157\232\254\200\020\128~\196\239h\219\224\\@\008l\210\011\246\007\015\214\138\030\215\130w$\1308\253\208\02737\152\010"])
end)

Items.newButton("Get M1 Carabine", "", function()
  GetItem(workspace.pickups["M1 Carabine"]["\176\013K:\166\231U\161\018,N\147\191+\254\006\221\021.=\229+\2362\160\209Rl=\"\145P\133N\154\208\232\205-\1376[\024\150|\176\199\146\247\204"])
end)

Items.newButton("Get M60", "", function()
  GetItem(workspace.pickups.M60["\209C\221\142\187\134%\221\164L8\024\128\164\004\177u1b\012]\235v\250\251\165e\157\175\1357\016Sj\022\204n\221\130\196\157\255\233\141g\131fr[9"])
end)

Items.newButton("Get SPAS", "", function()
  GetItem(workspace.pickups.SPAS:FindFirstChildOfClass("MeshPart"))
end)

Items.newButton("Get FAL Gun", "", function()
  GetItem(FindSource("FAL"):FindFirstChildOfClass("MeshPart"))
end)

Items.newButton("Get Hammer", "", function()
  GetItem(workspace.pickups.Hammer["\185\216\128\240\154d\129rqa\231\217\241V\223'\031\028\012a\207\178]\015\243\020\158\229\132\151\1329KB\163a\004\2546\023\241Z@\155\199\131\014\159p3"])
end)

Items.newButton("Get Apple", "", function()
  GetItem(FindSource("Apple"):FindFirstChildOfClass("MeshPart"))
end)

Items.newButton("Get Bat", "", function()
  GetItem(FindSource("Bat"):FindFirstChildOfClass("MeshPart"))
end)

Items.newButton("Get Baton", "", function()
  GetItem(FindSource("Baton"):FindFirstChildOfClass("MeshPart"))
end)

Items.newButton("Get Holy Bible", '', function()
  GetItem(workspace.pickups["Holy Bible"]["\002\240\154\019\131\132\190\214\144\174\025\216\141\187\161L14!J\134W\226\009\027&\150\2492\131\205\026,\219_\231\254\148kafJ\134\171K~u\227\168h"])
end)

Main.newToggle("Force Field", "", false, function(state)
  forceField = state
end)

Items.newButton('Get Cap Hat', "", function()
    local source = workspace.pickups.Cap["\180*.\208\205\226\240\167\173k\231\219E\225)0R\"\187\187\0147K\196.`\241\028\160\026HO\\\012\161\1700\018\206\234\223\031\234\198\171\007O\014\001L"]
    SavedPositions.Cap = LocalPlayer.Character.HumanoidRootPart.CFrame
    repeat task.wait()
        game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = source.CFrame
        game.ReplicatedStorage.RemoteEvent:FireServer("ItemHandler",source)
    until LocalPlayer.Character:FindFirstChild("Cap")
    LocalPlayer.Character.HumanoidRootPart.CFrame = SavedPositions.Cap
end)

Items.newButton('Get Famas Gun', "", function()
    GetItem(workspace.pickups.Famas.Carry)
end)

Main.newToggle("Copy Chat", "", false, function(state)
  copyChat = state
end)

local lochar = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local function ondiedevent()
	coroutine.wrap(function()
		Connections.Died:Disconnect(); SaveCamPos()
		SavedPositions.AutoRe = lochar:WaitForChild("HumanoidRootPart", 1) and LocalPlayer.Character:FindFirstChild("HumanoidRootPart").CFrame; Camera.CameraType = Enum.CameraType.Track
        if autoRespawn then
            sent = true; local team = LocalPlayer.Team
            if team == Teams.Criminals then
                game.ReplicatedStorage.RemoteEvent:FireServer("ChangeTeam", Teams.Neutral)
                game.ReplicatedStorage.RemoteEvent:FireServer("ChangeTeam", Teams.Criminals)
            elseif team == Teams.Prisoners then
                game.ReplicatedStorage.RemoteEvent:FireServer("ChangeTeam", Teams.Neutral)
                game.ReplicatedStorage.RemoteEvent:FireServer("ChangeTeam", Teams.Prisoners)
            elseif team == Teams.Police then
                game.ReplicatedStorage.RemoteEvent:FireServer("ChangeTeam", Teams.Neutral)
                game.ReplicatedStorage.RemoteEvent:FireServer("ChangeTeam", Teams.Police)
            else
                game.ReplicatedStorage.RemoteEvent:FireServer("ChangeTeam", Teams.Prisoners)
                game.ReplicatedStorage.RemoteEvent:FireServer("ChangeTeam", Teams.Neutral)
            end
        end
	end)()
end
for i,v in ipairs(game.Players:GetPlayers()) do
    if v ~= LocalPlayer then
        CopyChat(v)
    end
end
local function charaddtask()
	local LHuman = lochar:WaitForChild("Humanoid", 1)
	if LHuman then
        if not Saved.AutoRespawn then autoRespawn = false end
        if Connections.Died then Connections.Died:Disconnect(); Connections.Died = nil end
        if Connections.Animation then Connections.Animation:Disconnect(); Connections.Animation = nil end
        Connections.Died = LHuman.Died:Connect(ondiedevent)
        Connections.Animation = LHuman.AnimationPlayed:Connect(function(anim)
               if anim.Animation.AnimationId == "rbxassetid://125882711002228" and antiTase then
                      anim:Stop(); anim:Destroy()
                      game.RunService.RenderStepped:Wait(); LocalPlayer.Character.Humanoid.WalkSpeed = Saved.NormalSpeed
               end
               if anim.Animation.AnimationId == "rbxassetid://103349191835500" and antiArrest then
                      Refresh()
               end
        end)
        looped = true
        while looped and task.wait(.05) do
               if LocalPlayer.Character and looped then
                      if looped and LocalPlayer.Team ~= Teams.Prisoners and forceField and not LocalPlayer.Character:FindFirstChild("ForceField") then
                             looped = false; Refresh()
                      end
               end
        end
	end
end
local function oncharadded()
	lochar = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
	if SavedPositions.AutoRe and autoRespawn and sent then
		local LRoot = lochar:WaitForChild("HumanoidRootPart", 1)
		if LRoot then
			LRoot.CFrame = SavedPositions.AutoRe; LoadCamPos(); LRoot.CFrame = SavedPositions.AutoRe; sent = false
			task.spawn(function()
				for i = 1, 5 do
					task.wait(); LRoot.CFrame = SavedPositions.AutoRe
				end
			end)
		end
	end
	lochar:WaitForChild("Humanoid", 1):SetStateEnabled(Enum.HumanoidStateType.FallingDown, false)
	lochar:WaitForChild("Humanoid", 1):SetStateEnabled(Enum.HumanoidStateType.Ragdoll, false)
    coroutine.wrap(charaddtask)()
end
Connections.Died = lochar:WaitForChild("Humanoid").Died:Connect(ondiedevent)
Connections.CharacterAdded = LocalPlayer.CharacterAdded:Connect(oncharadded)
Connections.PlayerAdded = game.Players.PlayerAdded:Connect(CopyChat)

task.spawn(function()
  task1 = function()
    if killAura then
      for i,v in ipairs(game.Players:GetPlayers()) do
        if not v.Character:FindFirstChild("ForceField") and v.Character.Humanoid.Health ~= 0 then
          if v ~= LocalPlayer and (LocalPlayer.Character.HumanoidRootPart.Position - v.Character.HumanoidRootPart.Position).Magnitude <= 15 then
            game.ReplicatedStorage.RemoteEvent:FireServer("meleeEvent", v.Character:FindFirstChild("Humanoid"))
          end
        end
      end
    end
    if antiArrest then
      for i,v in ipairs(game.Teams.Police:GetPlayers()) do
        if not v.Character:FindFirstChild("ForceField") and v.Character.Humanoid.Health ~= 0 then
          if (LocalPlayer.Character.HumanoidRootPart.Position - v.Character.HumanoidRootPart.Position).Magnitude <= 20 and v ~= LocalPlayer and v.Character:FindFirstChild("Handcuffs") then
            game.ReplicatedStorage.RemoteEvent:FireServer("meleeEvent", v.Character:FindFirstChild("Humanoid"))
          end
        end
      end
    end
  end
  while task.wait() do
    task.spawn(task1)
  end
end)
